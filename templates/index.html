<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Battle ‚Äî Home</title>
    <link href="https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* Merge of home + index styles */
        body {
            font-family: 'Georgia', serif;
            /* Use the same gradient/color as the main stylesheet instead of an image */
            background: linear-gradient(135deg, #2e3d1f 0%, #1a2312 100%);
            color: #f8e5b3;
            text-align: center;
            margin: 0;
            padding: 0;
        }
        .overlay {
            /* overlay not needed when using a solid/gradient background */
            display: none;
        }
        .site-title {
            margin-top: 60px;
            font-size: 3em;
            color: #ffcc66;
            text-shadow: 2px 2px 10px #8b0000;
            font-family: 'MedievalSharp', cursive;
        }
        .tagline {
            font-family: 'MedievalSharp', cursive;
            font-size: 1.2em;
            color: #f5deb3;
            margin-top: 6px;
        }
        .scroll-box {
            background: rgba(40, 20, 10, 0.85);
            border: 3px solid #b8860b;
            border-radius: 15px;
            max-width: 1000px;
            margin: 30px auto;
            padding: 30px;
            box-shadow: 0 0 25px #000;
            display: flex;
            flex-direction: row;
            gap: 20px;
            align-items: center;
            
        }
        .intro {
            flex: 2;
            text-align: left;
            color: #f5deb3;
        }
        .controls {
            flex: 1;
            text-align: center;
        }
        .btn {
            display: inline-block;
            margin: 12px 10px;
            padding: 12px 28px;
            font-size: 1.15em;
            border-radius: 8px;
            border: 2px solid #b8860b;
            background: linear-gradient(145deg, #8b0000, #3b0000);
            color: #f8e5b3;
            text-decoration: none;
            font-weight: bold;
            box-shadow: 1px 1px 6px #0008;
            transition: transform 0.15s, box-shadow 0.15s;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px #0008; }
        .small { font-size: 0.9em; padding: 10px 18px; }
        footer { margin-top: 40px; color: #d2b48c; }
        @media (max-width: 800px) {
            .scroll-box { flex-direction: column; padding: 20px; }
            .intro { text-align: center; }
        }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <div class="site-title">‚öîÔ∏è Quiz Battle: Dungeons of Knowledge ‚öîÔ∏è</div>
    <div class="tagline">Fight enemies while learning Unix commands ‚Äî conquer the dungeon!</div>

    <div class="scroll-box">
        <div class="intro">
            <h2>Brave adventurer, your quest awaits!</h2>
            <p>
                Test your wisdom in the mystical Quiz Battle. Each correct answer strikes down your foes ‚Äî
                but beware, for every mistake weakens your spirit! Conquer all 10 enemies and earn your title as the
                <strong>Ultimate Champion of the Realm</strong>.
            </p>
            <p style="margin-top:12px; color:#f0d9b5;">Quick tips: answer fast for bonus damage; use keywords when unsure; watch your health and the timer.</p>
        </div>

        <div class="controls">
            <a href="{{ url_for('select_level') }}" class="btn">üéÆ Start Game</a>
            <a href="{{ url_for('test_yourself', new=1) }}" class="btn">üß™ Test Yourself</a>
            <a href="{{ url_for('endless') }}" class="btn">‚ôæÔ∏è Endless Mode</a>
            <a href="{{ url_for('howto') }}" class="btn small">üìú How to Play</a>
            
            <!-- Auto-save Load Progress Section -->
            <div id="auto-save-section" style="margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px; border: 1px solid #b8860b;">
                <div style="color: #f0d9b5; margin-bottom: 10px; font-size: 0.9em;">üíæ Load Saved Progress</div>
                <form onsubmit="loadProgress(event)" style="display: flex; flex-direction: column; gap: 8px;">
                    <input type="text" id="player-name-input" placeholder="Enter your name..." 
                           style="padding: 8px; border-radius: 4px; border: 1px solid #b8860b; background: #2a1a0f; color: #f0d9b5; text-align: center;">
                    <button type="submit" class="btn small" style="margin: 0;">üîÑ Load Progress</button>
                </form>
                <div id="save-status" style="margin-top: 8px; font-size: 0.8em; color: #d0d0d0;"></div>
            </div>
            
            <div style="margin-top:14px; font-size:0.9em; color:#e6d3b0;">Already have a level selected? Continue to play.</div>
        </div>
    </div>

    <footer>
        <p>&copy; Quiz Battle ‚Äî Built for learning and fun</p>
        <div style="margin-top: 10px;">
            <a href="{{ url_for('teacher_login') }}" style="color: #b8860b; text-decoration: none; font-size: 0.9em;">
                üéì Teacher Portal
            </a>
        </div>
    </footer>

    <script>
        // Auto-save functionality
        function loadProgress(event) {
            event.preventDefault();
            const playerName = document.getElementById('player-name-input').value.trim();
            if (!playerName) {
                document.getElementById('save-status').textContent = 'Please enter your name first.';
                return;
            }

            // Check if auto-save exists first
            fetch(`/check_auto_save/${encodeURIComponent(playerName)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.exists) {
                        const saveDate = new Date(data.timestamp * 1000).toLocaleString();
                        if (confirm(`Found saved progress!\nLevel: ${data.level}\nScore: ${data.score}\nSaved: ${saveDate}\n\nDo you want to load this progress?`)) {
                            // Create form and submit to load progress
                            const form = document.createElement('form');
                            form.method = 'POST';
                            form.action = '/load_progress';
                            
                            const input = document.createElement('input');
                            input.type = 'hidden';
                            input.name = 'player_name';
                            input.value = playerName;
                            
                            form.appendChild(input);
                            document.body.appendChild(form);
                            form.submit();
                        }
                    } else {
                        document.getElementById('save-status').textContent = 'No saved progress found for this name.';
                    }
                })
                .catch(error => {
                    document.getElementById('save-status').textContent = 'Error checking for saved progress.';
                    console.error('Error:', error);
                });
        }

        // Check if player name input changes
        document.getElementById('player-name-input').addEventListener('input', function() {
            document.getElementById('save-status').textContent = '';
        });
    </script>
</body>
</html>
