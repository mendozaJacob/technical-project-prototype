<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Metadata and linking the CSS file -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gamify RPG - Game</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Main container for the game content -->
    <div class="container game-layout">
        <!-- Left column: player avatar -->
        <div class="avatar-column">
            {% if session.get('character') %}
            <img class="player-avatar" src="{{ url_for('static', filename='characters/character' ~ session.get('character') ~ '.png') }}" alt="Player avatar">
            {% else %}
            <div class="player-avatar placeholder">üßë</div>
            {% endif %}
            <p class="avatar-label">Player</p>
        </div>

        <!-- Right column: game info -->
        <div class="game-column">
            <!-- Display the current level and enemy details -->
            <div class="enemy">
                <h2>Level {{ level }}: {{ enemy.name }}</h2>
                <p><em>{{ enemy.taunt }}</em></p>
            </div>

            <!-- Display player and enemy stats -->
            <p>Player HP: {{ player_hp }}</p>
            <p>Enemy HP: {{ enemy_hp }}</p>
            <p>Score: {{ score }}</p>

            <!-- Display the current question -->
            <h2>Question {{ q_number }} of {{ total }}</h2>
            <p>{{ question['q'] }}</p>
            <form method="POST">
                <input type="text" name="answer" placeholder="Type your command..." required>
                <button type="submit" class="btn">Attack!</button>
            </form>
        </div>

            <!-- Right column: enemy avatar -->
            <div class="enemy-column">
                {% if enemy_image %}
                    <img class="player-avatar" src="{{ enemy_image }}" alt="Enemy avatar">
                {% else %}
                    <div class="player-avatar placeholder">{{ enemy.avatar }}</div>
                {% endif %}
                <p class="avatar-label">Enemy</p>
            </div>
    </div>

    <!-- Status section for additional stats -->
    <div class="status">
        <!-- Display player stats -->
        <p>üßë Player HP: {{ player_hp }}</p>
        <p>üëæ Enemy HP: {{ enemy_hp }}</p>
        <p>‚≠ê Score: {{ score }}</p>
        <!-- Display the timer -->
        <p id="timer">‚è±Ô∏è Time Left: {{ time_left }} seconds</p>
    </div>

    <!-- Form for submitting the player's answer -->
    <form method="POST">
        <input type="text" name="answer" placeholder="Type your command..." required>
        <button type="submit" class="btn">Attack!</button>
    </form>

    <script>
        // Initialize the remaining time from the backend
        let timeLeft = {{ time_left }};
        const timerElement = document.getElementById("timer");

        // Countdown logic to update the timer every second
        const countdown = setInterval(() => {
            if (timeLeft > 0) {
                // Decrease the time left and update the timer text
                timeLeft--;
                timerElement.innerText = "‚è±Ô∏è Time Left: " + timeLeft + " seconds";
            } else {
                // Stop the countdown when time reaches 0
                clearInterval(countdown);
                timerElement.innerText = "‚è≥ Time's up!";
            }
        }, 1000); // Run the function every 1000ms (1 second)
    </script>
</body>
</html>
